USE PedidosP
GO

-- DESHABILITAR CONSTRAINTS DE CLIENTE, CABEZERAP Y DETALLEP
ALTER TABLE catalogo.Cliente DROP CONSTRAINT pk_Cliente 
ALTER TABLE movimiento.CabezeraP DROP CONSTRAINT pk_CabezeraP 
ALTER TABLE movimiento.DetalleP DROP CONSTRAINT pk_DetalleP
GO

-- AUMENTAR EL TAMAÑO DEL CAMPO CODCLI DEL CLIENTE Y CABEZERAP
ALTER TABLE catalogo.Cliente
ALTER COLUMN codcli CHAR(6)

ALTER TABLE movimiento.CabeceraP
ALTER COLUMN codcli CHAR(6)
GO

-- ACTUALIZAR VALORES DEL CAMPO CODCLI DEL CLIENTE Y CABEZERAP
UPDATE catalogo.Cliente
SET codcli = SUBSTRING(codcli,1,1) + '000' + SUBSTRING(codcli,DATALENGTH(codcli)-1,2)

UPDATE movimiento.CabezeraP
SET codcli = SUBSTRING(codcli,1,1) + '000' + SUBSTRING(codcli,DATALENGTH(codcli)-1,2)
GO

-- MODIFICAR TAMAÑO DEL CAMPO CODPED DE CABEZERAP Y DETALLEP
ALTER TABLE movimiento.CabezeraP
ALTER COLUMN codped CHAR(10)

ALTER TABLE movimiento.DetalleP
ALTER COLUMN codped CHAR(10)
GO

-- ACTUALIZAR VALORES DEL CAMPO CODPED DE CABEZERAP Y DETALLEP
UPDATE movimiento.CabezeraP
SET codped = 'PE000000' + SUBSTRING(codped,DATALENGTH(codped)-1,2)

UPDATE movimiento.DetalleP
SET codped = 'PE000000' + SUBSTRING(codped,DATALENGTH(codped)-1,2)
GO

-- HABILITAR CONSTRAINTS DE CLIENTE, CABEZERAP Y DETALLEP
ALTER TABLE catalogo.Cliente 
ADD CONSTRAINT pk_Cliente PRIMARY KEY CLUSTERED (codcli) 

ALTER TABLE movimiento.CabezeraP
ADD CONSTRAINT pk_CabezeraP PRIMARY KEY CLUSTERED (codped)  

ALTER TABLE movimiento.DetalleP
ADD CONSTRAINT pk_DetalleP PRIMARY KEY CLUSTERED (numlinea, codped)
